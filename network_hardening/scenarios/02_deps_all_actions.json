{
  "scenario_name": "02_deps_all_actions",
  "description": "Dipendenze tra servizi",
  "hosts": [
    {
      "id": "frontend",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "backend",
      "open_ports": [
        8080,
        22
      ],
      "services": [
        "tomcat",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "mailserver",
      "open_ports": [
        25,
        22
      ],
      "services": [
        "smtp",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "database",
      "open_ports": [
        3306,
        22,
        23
      ],
      "services": [
        "mysql",
        "ssh"
      ],
      "critical": true
    }
  ],
  "policy": {
    "forbidden_ports": [
      80,
      25,
      23
    ],
    "critical_services": {
      "database": [
        "mysql"
      ]
    }
  },
  "service_port_mapping": {
    "http": [
      80
    ],
    "https": [
      443
    ],
    "ssh": [
      22
    ],
    "mysql": [
      3306
    ],
    "postgresql": [
      5432
    ],
    "redis": [
      6379
    ],
    "mongodb": [
      27017
    ],
    "ftp": [
      21
    ],
    "telnet": [
      23
    ],
    "smtp": [
      25
    ],
    "pop3": [
      110
    ],
    "imap": [
      143
    ],
    "tomcat": [
      8080
    ],
    "nodejs": [
      3000
    ],
    "rabbitmq": [
      5672
    ],
    "prometheus": [
      9090
    ],
    "grafana": [
      3000
    ],
    "elasticsearch": [
      9200
    ],
    "kibana": [
      5601
    ],
    "smb": [
      445
    ],
    "netbios": [
      139
    ],
    "rdp": [
      3389
    ],
    "vnc": [
      5900
    ],
    "nfs": [
      2049
    ],
    "ldap": [
      389
    ],
    "rsync": [
      873
    ],
    "snmp": [
      161
    ],
    "tftp": [
      69
    ]
  },
  "service_dependencies": {
    "frontend": {
      "http": [
        "tomcat"
      ]
    },
    "backend": {
      "tomcat": [
        "mysql"
      ]
    }
  }
}