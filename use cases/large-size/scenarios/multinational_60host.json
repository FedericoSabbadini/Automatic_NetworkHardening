{
  "scenario_name": "multinational_extreme",
  "description": "Multinazionale con 60 host distribuiti su 4 region (EU, US, APAC, LATAM). ERP, CRM, Supply Chain, HR, Finance. Migrazione cloud ibrido.",
  "hosts": [
    {"id": "eu_lb_01", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "eu_lb_02", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "eu_web_01", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "eu_web_02", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "eu_web_03", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "eu_app_01", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": true},
    {"id": "eu_app_02", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": false},
    {"id": "eu_erp_01", "open_ports": [8080, 443, 22, 1521], "services": ["tomcat", "https", "ssh"], "critical": true},
    {"id": "eu_erp_02", "open_ports": [8080, 443, 22, 1521], "services": ["tomcat", "https", "ssh"], "critical": true},
    {"id": "eu_crm_01", "open_ports": [8080, 443, 22, 25], "services": ["tomcat", "https", "ssh", "smtp"], "critical": false},
    {"id": "eu_db_master", "open_ports": [5432, 22, 23], "services": ["postgresql", "ssh"], "critical": true},
    {"id": "eu_db_replica", "open_ports": [5432, 22, 23, 139], "services": ["postgresql", "ssh"], "critical": false},
    {"id": "eu_redis_01", "open_ports": [6379, 22, 161], "services": ["redis", "ssh", "snmp"], "critical": true},
    {"id": "eu_redis_02", "open_ports": [6379, 22, 161], "services": ["redis", "ssh", "snmp"], "critical": false},
    {"id": "eu_mq_01", "open_ports": [5672, 22, 161], "services": ["rabbitmq", "ssh", "snmp"], "critical": true},
    
    {"id": "us_lb_01", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "us_lb_02", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "us_web_01", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "us_web_02", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "us_web_03", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "us_app_01", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": true},
    {"id": "us_app_02", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": false},
    {"id": "us_finance_01", "open_ports": [8080, 443, 22, 3389], "services": ["tomcat", "https", "ssh", "rdp"], "critical": true},
    {"id": "us_finance_02", "open_ports": [8080, 443, 22, 3389, 5900], "services": ["tomcat", "https", "ssh", "rdp", "vnc"], "critical": false},
    {"id": "us_hr_01", "open_ports": [8080, 443, 22, 389], "services": ["tomcat", "https", "ssh", "ldap"], "critical": true},
    {"id": "us_hr_02", "open_ports": [8080, 443, 22, 389, 25], "services": ["tomcat", "https", "ssh", "ldap", "smtp"], "critical": false},
    {"id": "us_db_master", "open_ports": [3306, 22, 23], "services": ["mysql", "ssh"], "critical": true},
    {"id": "us_db_replica", "open_ports": [3306, 22, 23, 139], "services": ["mysql", "ssh"], "critical": false},
    {"id": "us_redis_01", "open_ports": [6379, 22, 161], "services": ["redis", "ssh", "snmp"], "critical": true},
    {"id": "us_mq_01", "open_ports": [5672, 22, 161], "services": ["rabbitmq", "ssh", "snmp"], "critical": true},
    
    {"id": "apac_lb_01", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "apac_lb_02", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "apac_web_01", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "apac_web_02", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "apac_web_03", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "apac_app_01", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": true},
    {"id": "apac_app_02", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": false},
    {"id": "apac_supply_01", "open_ports": [8080, 443, 22, 21], "services": ["tomcat", "https", "ssh", "ftp"], "critical": true},
    {"id": "apac_supply_02", "open_ports": [8080, 443, 22, 21, 69], "services": ["tomcat", "https", "ssh", "ftp", "tftp"], "critical": false},
    {"id": "apac_warehouse_01", "open_ports": [8080, 22, 139, 445], "services": ["tomcat", "ssh", "netbios", "smb"], "critical": false},
    {"id": "apac_warehouse_02", "open_ports": [8080, 22, 139, 445], "services": ["tomcat", "ssh", "netbios", "smb"], "critical": false},
    {"id": "apac_db_master", "open_ports": [5432, 22, 23], "services": ["postgresql", "ssh"], "critical": true},
    {"id": "apac_db_replica", "open_ports": [5432, 22, 23, 139], "services": ["postgresql", "ssh"], "critical": false},
    {"id": "apac_redis_01", "open_ports": [6379, 22, 161], "services": ["redis", "ssh", "snmp"], "critical": true},
    {"id": "apac_mq_01", "open_ports": [5672, 22, 161], "services": ["rabbitmq", "ssh", "snmp"], "critical": true},
    
    {"id": "latam_lb_01", "open_ports": [80, 443, 22, 8080], "services": ["http", "https", "ssh", "tomcat"], "critical": false},
    {"id": "latam_web_01", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "latam_web_02", "open_ports": [80, 443, 22, 3000], "services": ["http", "https", "ssh", "nodejs"], "critical": false},
    {"id": "latam_app_01", "open_ports": [8080, 22, 5672, 161], "services": ["tomcat", "ssh", "rabbitmq", "snmp"], "critical": true},
    {"id": "latam_legacy_01", "open_ports": [8080, 22, 23, 21, 25], "services": ["tomcat", "ssh", "ftp", "smtp"], "critical": false},
    {"id": "latam_legacy_02", "open_ports": [8080, 22, 23, 139, 69], "services": ["tomcat", "ssh", "netbios", "tftp"], "critical": false},
    {"id": "latam_db_master", "open_ports": [3306, 22, 23], "services": ["mysql", "ssh"], "critical": true},
    {"id": "latam_db_replica", "open_ports": [3306, 22, 23, 139], "services": ["mysql", "ssh"], "critical": false},
    {"id": "latam_redis_01", "open_ports": [6379, 22, 161], "services": ["redis", "ssh", "snmp"], "critical": false},
    
    {"id": "global_dns_01", "open_ports": [53, 22, 161], "services": ["ssh", "snmp"], "critical": true},
    {"id": "global_dns_02", "open_ports": [53, 22, 161], "services": ["ssh", "snmp"], "critical": false},
    {"id": "global_monitoring", "open_ports": [9090, 3000, 22, 80, 23], "services": ["prometheus", "grafana", "ssh", "http"], "critical": false},
    {"id": "global_siem", "open_ports": [9200, 5601, 22, 161], "services": ["elasticsearch", "kibana", "ssh", "snmp"], "critical": true},
    {"id": "global_backup", "open_ports": [22, 873, 21, 69], "services": ["ssh", "rsync", "ftp", "tftp"], "critical": false},
    {"id": "global_admin", "open_ports": [22, 3389, 5900, 69, 23], "services": ["ssh", "rdp", "vnc", "tftp"], "critical": false}
  ],
  "policy": {
    "forbidden_ports": [80, 21, 23, 25, 139, 161, 69, 389, 3389, 5900],
    "critical_services": {
      "eu_app_01": ["tomcat", "rabbitmq"],
      "eu_erp_01": ["tomcat", "https"],
      "eu_erp_02": ["tomcat", "https"],
      "eu_db_master": ["postgresql"],
      "eu_redis_01": ["redis"],
      "eu_mq_01": ["rabbitmq"],
      "us_app_01": ["tomcat", "rabbitmq"],
      "us_finance_01": ["tomcat", "https"],
      "us_hr_01": ["tomcat", "https", "ldap"],
      "us_db_master": ["mysql"],
      "us_redis_01": ["redis"],
      "us_mq_01": ["rabbitmq"],
      "apac_app_01": ["tomcat", "rabbitmq"],
      "apac_supply_01": ["tomcat", "https"],
      "apac_db_master": ["postgresql"],
      "apac_redis_01": ["redis"],
      "apac_mq_01": ["rabbitmq"],
      "latam_app_01": ["tomcat", "rabbitmq"],
      "latam_db_master": ["mysql"],
      "global_dns_01": ["ssh"],
      "global_siem": ["elasticsearch", "kibana"]
    }
  },
  "service_port_mapping": {
    "http": [80], "https": [443], "ssh": [22], "mysql": [3306], "postgresql": [5432],
    "redis": [6379], "mongodb": [27017], "ftp": [21], "telnet": [23], "smtp": [25],
    "pop3": [110], "imap": [143], "tomcat": [8080], "nodejs": [3000], "rabbitmq": [5672],
    "prometheus": [9090], "grafana": [3000], "elasticsearch": [9200], "kibana": [5601],
    "smb": [445], "netbios": [139], "rdp": [3389], "vnc": [5900], "nfs": [2049],
    "ldap": [389], "rsync": [873], "snmp": [161], "tftp": [69]
  },
  "service_dependencies": {
    "eu_lb_01": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "eu_lb_02": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "eu_web_01": {"nodejs": ["tomcat"]},
    "eu_web_02": {"nodejs": ["tomcat"]},
    "eu_web_03": {"nodejs": ["tomcat"]},
    "eu_app_01": {"tomcat": ["rabbitmq", "postgresql"]},
    "eu_app_02": {"tomcat": ["rabbitmq", "postgresql"]},
    "eu_erp_01": {"tomcat": ["postgresql"]},
    "eu_erp_02": {"tomcat": ["postgresql"]},
    "eu_crm_01": {"tomcat": ["smtp", "postgresql"]},
    "us_lb_01": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "us_lb_02": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "us_web_01": {"nodejs": ["tomcat"]},
    "us_web_02": {"nodejs": ["tomcat"]},
    "us_web_03": {"nodejs": ["tomcat"]},
    "us_app_01": {"tomcat": ["rabbitmq", "mysql"]},
    "us_app_02": {"tomcat": ["rabbitmq", "mysql"]},
    "us_finance_01": {"tomcat": ["mysql"]},
    "us_finance_02": {"tomcat": ["mysql"], "rdp": ["tomcat"]},
    "us_hr_01": {"tomcat": ["ldap", "mysql"]},
    "us_hr_02": {"tomcat": ["ldap", "smtp", "mysql"]},
    "apac_lb_01": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "apac_lb_02": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "apac_web_01": {"nodejs": ["tomcat"]},
    "apac_web_02": {"nodejs": ["tomcat"]},
    "apac_web_03": {"nodejs": ["tomcat"]},
    "apac_app_01": {"tomcat": ["rabbitmq", "postgresql"]},
    "apac_app_02": {"tomcat": ["rabbitmq", "postgresql"]},
    "apac_supply_01": {"tomcat": ["ftp", "postgresql"]},
    "apac_supply_02": {"tomcat": ["ftp", "postgresql"]},
    "apac_warehouse_01": {"tomcat": ["netbios", "smb"]},
    "apac_warehouse_02": {"tomcat": ["netbios", "smb"]},
    "latam_lb_01": {"http": ["nodejs"], "tomcat": ["nodejs"]},
    "latam_web_01": {"nodejs": ["tomcat"]},
    "latam_web_02": {"nodejs": ["tomcat"]},
    "latam_app_01": {"tomcat": ["rabbitmq", "mysql"]},
    "latam_legacy_01": {"tomcat": ["ftp", "smtp"]},
    "latam_legacy_02": {"tomcat": ["netbios", "tftp"]},
    "global_monitoring": {"grafana": ["prometheus"]},
    "global_siem": {"kibana": ["elasticsearch"]},
    "global_backup": {"rsync": ["ftp"]}
  }
}
