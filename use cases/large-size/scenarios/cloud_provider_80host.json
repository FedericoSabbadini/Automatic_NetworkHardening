{
  "scenario_name": "cloud_provider_extreme",
  "description": "Cloud provider con 80 host: multi-tenant infrastructure, container orchestration, storage cluster, network fabric, security stack. ISO 27001 audit.",
  "hosts": [
    {
      "id": "edge_pop_eu_01",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "edge_pop_eu_02",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "edge_pop_us_01",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "edge_pop_us_02",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "edge_pop_apac_01",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "edge_pop_apac_02",
      "open_ports": [
        80,
        443,
        22
      ],
      "services": [
        "http",
        "https",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "api_gateway_01",
      "open_ports": [
        443,
        8080,
        22,
        161
      ],
      "services": [
        "https",
        "tomcat",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "api_gateway_02",
      "open_ports": [
        443,
        8080,
        22,
        161
      ],
      "services": [
        "https",
        "tomcat",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "api_gateway_03",
      "open_ports": [
        443,
        8080,
        22,
        161
      ],
      "services": [
        "https",
        "tomcat",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "auth_service_01",
      "open_ports": [
        8080,
        443,
        22,
        389
      ],
      "services": [
        "tomcat",
        "https",
        "ssh",
        "ldap"
      ],
      "critical": true
    },
    {
      "id": "auth_service_02",
      "open_ports": [
        8080,
        443,
        22,
        389
      ],
      "services": [
        "tomcat",
        "https",
        "ssh",
        "ldap"
      ],
      "critical": true
    },
    {
      "id": "auth_service_03",
      "open_ports": [
        8080,
        443,
        22,
        389
      ],
      "services": [
        "tomcat",
        "https",
        "ssh",
        "ldap"
      ],
      "critical": false
    },
    {
      "id": "billing_01",
      "open_ports": [
        8080,
        443,
        22,
        25
      ],
      "services": [
        "tomcat",
        "https",
        "ssh",
        "smtp"
      ],
      "critical": true
    },
    {
      "id": "billing_02",
      "open_ports": [
        8080,
        443,
        22,
        25
      ],
      "services": [
        "tomcat",
        "https",
        "ssh",
        "smtp"
      ],
      "critical": false
    },
    {
      "id": "k8s_master_01",
      "open_ports": [
        6443,
        2379,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "k8s_master_02",
      "open_ports": [
        6443,
        2379,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "k8s_master_03",
      "open_ports": [
        6443,
        2379,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "k8s_worker_01",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_02",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_03",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_04",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_05",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_06",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_07",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "k8s_worker_08",
      "open_ports": [
        10250,
        22,
        80,
        443
      ],
      "services": [
        "ssh",
        "http",
        "https"
      ],
      "critical": false
    },
    {
      "id": "ceph_mon_01",
      "open_ports": [
        6789,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "ceph_mon_02",
      "open_ports": [
        6789,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "ceph_mon_03",
      "open_ports": [
        6789,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "ceph_osd_01",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "ceph_osd_02",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "ceph_osd_03",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "ceph_osd_04",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "ceph_osd_05",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "ceph_osd_06",
      "open_ports": [
        6800,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "nfs_server_01",
      "open_ports": [
        2049,
        111,
        22,
        139
      ],
      "services": [
        "nfs",
        "ssh",
        "netbios"
      ],
      "critical": false
    },
    {
      "id": "nfs_server_02",
      "open_ports": [
        2049,
        111,
        22,
        139
      ],
      "services": [
        "nfs",
        "ssh",
        "netbios"
      ],
      "critical": false
    },
    {
      "id": "smb_server_01",
      "open_ports": [
        445,
        139,
        22
      ],
      "services": [
        "smb",
        "netbios",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "smb_server_02",
      "open_ports": [
        445,
        139,
        22
      ],
      "services": [
        "smb",
        "netbios",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "db_postgres_01",
      "open_ports": [
        5432,
        22,
        23
      ],
      "services": [
        "postgresql",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_postgres_02",
      "open_ports": [
        5432,
        22,
        23
      ],
      "services": [
        "postgresql",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_postgres_03",
      "open_ports": [
        5432,
        22,
        23
      ],
      "services": [
        "postgresql",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "db_mysql_01",
      "open_ports": [
        3306,
        22,
        23
      ],
      "services": [
        "mysql",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_mysql_02",
      "open_ports": [
        3306,
        22,
        23
      ],
      "services": [
        "mysql",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_mysql_03",
      "open_ports": [
        3306,
        22,
        23
      ],
      "services": [
        "mysql",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "db_mongo_01",
      "open_ports": [
        27017,
        22,
        23
      ],
      "services": [
        "mongodb",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_mongo_02",
      "open_ports": [
        27017,
        22,
        23
      ],
      "services": [
        "mongodb",
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "db_mongo_03",
      "open_ports": [
        27017,
        22,
        23
      ],
      "services": [
        "mongodb",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "redis_cluster_01",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "redis_cluster_02",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "redis_cluster_03",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "redis_cluster_04",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "redis_cluster_05",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "redis_cluster_06",
      "open_ports": [
        6379,
        16379,
        22,
        161
      ],
      "services": [
        "redis",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "mq_kafka_01",
      "open_ports": [
        9092,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "mq_kafka_02",
      "open_ports": [
        9092,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "mq_kafka_03",
      "open_ports": [
        9092,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "mq_rabbit_01",
      "open_ports": [
        5672,
        15672,
        22,
        161
      ],
      "services": [
        "rabbitmq",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "mq_rabbit_02",
      "open_ports": [
        5672,
        15672,
        22,
        161
      ],
      "services": [
        "rabbitmq",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "mq_rabbit_03",
      "open_ports": [
        5672,
        15672,
        22,
        161
      ],
      "services": [
        "rabbitmq",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "elk_elastic_01",
      "open_ports": [
        9200,
        9300,
        22,
        161
      ],
      "services": [
        "elasticsearch",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "elk_elastic_02",
      "open_ports": [
        9200,
        9300,
        22,
        161
      ],
      "services": [
        "elasticsearch",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "elk_elastic_03",
      "open_ports": [
        9200,
        9300,
        22,
        161
      ],
      "services": [
        "elasticsearch",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "elk_kibana_01",
      "open_ports": [
        5601,
        22,
        80
      ],
      "services": [
        "kibana",
        "ssh",
        "http"
      ],
      "critical": false
    },
    {
      "id": "elk_logstash_01",
      "open_ports": [
        5044,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "elk_logstash_02",
      "open_ports": [
        5044,
        22,
        161
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "monitor_prometheus_01",
      "open_ports": [
        9090,
        22,
        161
      ],
      "services": [
        "prometheus",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "monitor_prometheus_02",
      "open_ports": [
        9090,
        22,
        161
      ],
      "services": [
        "prometheus",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "monitor_grafana_01",
      "open_ports": [
        3000,
        22,
        80
      ],
      "services": [
        "grafana",
        "ssh",
        "http"
      ],
      "critical": false
    },
    {
      "id": "monitor_alertmanager",
      "open_ports": [
        9093,
        22,
        25
      ],
      "services": [
        "ssh",
        "smtp"
      ],
      "critical": false
    },
    {
      "id": "security_vault_01",
      "open_ports": [
        8200,
        22
      ],
      "services": [
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "security_vault_02",
      "open_ports": [
        8200,
        22
      ],
      "services": [
        "ssh"
      ],
      "critical": true
    },
    {
      "id": "security_waf_01",
      "open_ports": [
        80,
        443,
        22,
        161
      ],
      "services": [
        "http",
        "https",
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "security_waf_02",
      "open_ports": [
        80,
        443,
        22,
        161
      ],
      "services": [
        "http",
        "https",
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "security_ids_01",
      "open_ports": [
        22,
        161,
        514
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": true
    },
    {
      "id": "security_ids_02",
      "open_ports": [
        22,
        161,
        514
      ],
      "services": [
        "ssh",
        "snmp"
      ],
      "critical": false
    },
    {
      "id": "mgmt_bastion_01",
      "open_ports": [
        22,
        3389,
        5900
      ],
      "services": [
        "ssh",
        "rdp",
        "vnc"
      ],
      "critical": false
    },
    {
      "id": "mgmt_bastion_02",
      "open_ports": [
        22,
        3389,
        5900
      ],
      "services": [
        "ssh",
        "rdp",
        "vnc"
      ],
      "critical": false
    },
    {
      "id": "mgmt_ansible_01",
      "open_ports": [
        22,
        8080
      ],
      "services": [
        "ssh",
        "tomcat"
      ],
      "critical": false
    },
    {
      "id": "mgmt_jenkins_01",
      "open_ports": [
        8080,
        22,
        50000
      ],
      "services": [
        "tomcat",
        "ssh"
      ],
      "critical": false
    },
    {
      "id": "mgmt_nexus_01",
      "open_ports": [
        8081,
        22,
        21
      ],
      "services": [
        "ssh",
        "ftp"
      ],
      "critical": false
    },
    {
      "id": "mgmt_backup_01",
      "open_ports": [
        22,
        873,
        21,
        69
      ],
      "services": [
        "ssh",
        "rsync",
        "ftp",
        "tftp"
      ],
      "critical": false
    }
  ],
  "policy": {
    "forbidden_ports": [
      80,
      21,
      23,
      25,
      139,
      161,
      69,
      389,
      3389,
      5900
    ],
    "critical_services": {
      "api_gateway_01": [
        "https",
        "tomcat"
      ],
      "api_gateway_02": [
        "https",
        "tomcat"
      ],
      "auth_service_01": [
        "tomcat",
        "https",
        "ldap"
      ],
      "auth_service_02": [
        "tomcat",
        "https",
        "ldap"
      ],
      "billing_01": [
        "tomcat",
        "https"
      ],
      "k8s_master_01": [
        "ssh"
      ],
      "k8s_master_02": [
        "ssh"
      ],
      "k8s_master_03": [
        "ssh"
      ],
      "ceph_mon_01": [
        "ssh"
      ],
      "ceph_mon_02": [
        "ssh"
      ],
      "ceph_mon_03": [
        "ssh"
      ],
      "db_postgres_01": [
        "postgresql"
      ],
      "db_postgres_02": [
        "postgresql"
      ],
      "db_mysql_01": [
        "mysql"
      ],
      "db_mysql_02": [
        "mysql"
      ],
      "db_mongo_01": [
        "mongodb"
      ],
      "db_mongo_02": [
        "mongodb"
      ],
      "redis_cluster_01": [
        "redis"
      ],
      "redis_cluster_02": [
        "redis"
      ],
      "redis_cluster_03": [
        "redis"
      ],
      "mq_kafka_01": [
        "ssh"
      ],
      "mq_kafka_02": [
        "ssh"
      ],
      "mq_kafka_03": [
        "ssh"
      ],
      "mq_rabbit_01": [
        "rabbitmq"
      ],
      "elk_elastic_01": [
        "elasticsearch"
      ],
      "elk_elastic_02": [
        "elasticsearch"
      ],
      "monitor_prometheus_01": [
        "prometheus"
      ],
      "security_vault_01": [
        "ssh"
      ],
      "security_vault_02": [
        "ssh"
      ],
      "security_waf_01": [
        "http",
        "https"
      ],
      "security_ids_01": [
        "ssh"
      ]
    }
  },
  "service_port_mapping": {
    "http": [
      80
    ],
    "https": [
      443
    ],
    "ssh": [
      22
    ],
    "mysql": [
      3306
    ],
    "postgresql": [
      5432
    ],
    "redis": [
      6379
    ],
    "mongodb": [
      27017
    ],
    "ftp": [
      21
    ],
    "telnet": [
      23
    ],
    "smtp": [
      25
    ],
    "pop3": [
      110
    ],
    "imap": [
      143
    ],
    "tomcat": [
      8080
    ],
    "nodejs": [
      3000
    ],
    "rabbitmq": [
      5672
    ],
    "prometheus": [
      9090
    ],
    "grafana": [
      3000
    ],
    "elasticsearch": [
      9200
    ],
    "kibana": [
      5601
    ],
    "smb": [
      445
    ],
    "netbios": [
      139
    ],
    "rdp": [
      3389
    ],
    "vnc": [
      5900
    ],
    "nfs": [
      2049
    ],
    "ldap": [
      389
    ],
    "rsync": [
      873
    ],
    "snmp": [
      161
    ],
    "tftp": [
      69
    ]
  },
  "service_dependencies": {
    "edge_pop_eu_01": {
      "http": [
        "https"
      ]
    },
    "edge_pop_eu_02": {
      "http": [
        "https"
      ]
    },
    "edge_pop_us_01": {
      "http": [
        "https"
      ]
    },
    "edge_pop_us_02": {
      "http": [
        "https"
      ]
    },
    "edge_pop_apac_01": {
      "http": [
        "https"
      ]
    },
    "edge_pop_apac_02": {
      "http": [
        "https"
      ]
    },
    "api_gateway_01": {
      "tomcat": [
        "https"
      ]
    },
    "api_gateway_02": {
      "tomcat": [
        "https"
      ]
    },
    "api_gateway_03": {
      "tomcat": [
        "https"
      ]
    },
    "auth_service_01": {
      "tomcat": [
        "ldap",
        "https"
      ]
    },
    "auth_service_02": {
      "tomcat": [
        "ldap",
        "https"
      ]
    },
    "auth_service_03": {
      "tomcat": [
        "ldap",
        "https"
      ]
    },
    "billing_01": {
      "tomcat": [
        "https"
      ]
    },
    "billing_02": {
      "tomcat": [
        "https"
      ]
    },
    "k8s_worker_01": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_02": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_03": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_04": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_05": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_06": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_07": {
      "http": [
        "https"
      ]
    },
    "k8s_worker_08": {
      "http": [
        "https"
      ]
    },
    "nfs_server_01": {
      "nfs": [
        "netbios"
      ]
    },
    "nfs_server_02": {
      "nfs": [
        "netbios"
      ]
    },
    "smb_server_01": {
      "smb": [
        "netbios"
      ]
    },
    "smb_server_02": {
      "smb": [
        "netbios"
      ]
    },
    "elk_kibana_01": {
      "kibana": [
        "elasticsearch"
      ]
    },
    "monitor_grafana_01": {
      "grafana": [
        "prometheus"
      ]
    },
    "monitor_alertmanager": {
      "smtp": [
        "ssh"
      ]
    },
    "security_waf_01": {
      "http": [
        "https"
      ]
    },
    "security_waf_02": {
      "http": [
        "https"
      ]
    },
    "mgmt_backup_01": {
      "rsync": [
        "ftp"
      ]
    }
  }
}