{
  "scenario_name": "banking_multisite",
  "description": "Infrastruttura bancaria multi-sito con 30 host: core banking, trading platform, ATM network, fraud detection, disaster recovery. PCI-DSS e SWIFT compliance.",
  "hosts": [
    {
      "id": "core_banking_primary",
      "open_ports": [8080, 443, 22, 1521],
      "services": ["tomcat", "https", "ssh"],
      "critical": true
    },
    {
      "id": "core_banking_standby",
      "open_ports": [8080, 443, 22, 1521],
      "services": ["tomcat", "https", "ssh"],
      "critical": true
    },
    {
      "id": "trading_engine_01",
      "open_ports": [8080, 443, 22, 5672],
      "services": ["tomcat", "https", "ssh", "rabbitmq"],
      "critical": true
    },
    {
      "id": "trading_engine_02",
      "open_ports": [8080, 443, 22, 5672],
      "services": ["tomcat", "https", "ssh", "rabbitmq"],
      "critical": true
    },
    {
      "id": "market_data_feed",
      "open_ports": [443, 22, 9092],
      "services": ["https", "ssh"],
      "critical": true
    },
    {
      "id": "risk_calculator",
      "open_ports": [8080, 22, 6379],
      "services": ["tomcat", "ssh", "redis"],
      "critical": true
    },
    {
      "id": "web_banking_01",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "web_banking_02",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "mobile_api_gateway",
      "open_ports": [443, 8080, 22, 161],
      "services": ["https", "tomcat", "ssh", "snmp"],
      "critical": true
    },
    {
      "id": "atm_controller_01",
      "open_ports": [8080, 22, 23, 139],
      "services": ["tomcat", "ssh"],
      "critical": true
    },
    {
      "id": "atm_controller_02",
      "open_ports": [8080, 22, 23, 139],
      "services": ["tomcat", "ssh"],
      "critical": true
    },
    {
      "id": "pos_gateway",
      "open_ports": [443, 8080, 22, 21],
      "services": ["https", "tomcat", "ssh", "ftp"],
      "critical": false
    },
    {
      "id": "swift_gateway",
      "open_ports": [443, 22],
      "services": ["https", "ssh"],
      "critical": true
    },
    {
      "id": "fraud_detection_01",
      "open_ports": [8080, 22, 9200, 6379],
      "services": ["tomcat", "ssh", "elasticsearch", "redis"],
      "critical": true
    },
    {
      "id": "fraud_detection_02",
      "open_ports": [8080, 22, 9200, 6379],
      "services": ["tomcat", "ssh", "elasticsearch", "redis"],
      "critical": true
    },
    {
      "id": "aml_scanner",
      "open_ports": [8080, 22, 25],
      "services": ["tomcat", "ssh", "smtp"],
      "critical": false
    },
    {
      "id": "report_generator",
      "open_ports": [8080, 22, 139, 445],
      "services": ["tomcat", "ssh", "netbios", "smb"],
      "critical": false
    },
    {
      "id": "db_oracle_primary",
      "open_ports": [1521, 22],
      "services": ["ssh"],
      "critical": true
    },
    {
      "id": "db_oracle_standby",
      "open_ports": [1521, 22, 23],
      "services": ["ssh"],
      "critical": true
    },
    {
      "id": "db_postgres_audit",
      "open_ports": [5432, 22],
      "services": ["postgresql", "ssh"],
      "critical": true
    },
    {
      "id": "db_mysql_reports",
      "open_ports": [3306, 22, 23],
      "services": ["mysql", "ssh"],
      "critical": false
    },
    {
      "id": "mq_primary",
      "open_ports": [5672, 15672, 22, 161],
      "services": ["rabbitmq", "ssh", "snmp"],
      "critical": true
    },
    {
      "id": "mq_secondary",
      "open_ports": [5672, 15672, 22, 161],
      "services": ["rabbitmq", "ssh", "snmp"],
      "critical": false
    },
    {
      "id": "redis_session_01",
      "open_ports": [6379, 22],
      "services": ["redis", "ssh"],
      "critical": true
    },
    {
      "id": "redis_session_02",
      "open_ports": [6379, 22, 161],
      "services": ["redis", "ssh", "snmp"],
      "critical": false
    },
    {
      "id": "hsm_connector",
      "open_ports": [443, 22],
      "services": ["https", "ssh"],
      "critical": true
    },
    {
      "id": "ldap_directory",
      "open_ports": [389, 636, 22],
      "services": ["ldap", "ssh"],
      "critical": true
    },
    {
      "id": "siem_collector",
      "open_ports": [514, 9200, 5601, 22, 161],
      "services": ["elasticsearch", "kibana", "ssh", "snmp"],
      "critical": false
    },
    {
      "id": "admin_workstation",
      "open_ports": [22, 3389, 5900, 69],
      "services": ["ssh", "rdp", "vnc", "tftp"],
      "critical": false
    },
    {
      "id": "dr_coordinator",
      "open_ports": [8080, 22, 873, 23],
      "services": ["tomcat", "ssh", "rsync"],
      "critical": false
    }
  ],
  "policy": {
    "forbidden_ports": [80, 21, 23, 25, 139, 161, 69, 389, 3389, 5900],
    "critical_services": {
      "core_banking_primary": ["tomcat", "https"],
      "core_banking_standby": ["tomcat", "https"],
      "trading_engine_01": ["tomcat", "https", "rabbitmq"],
      "trading_engine_02": ["tomcat", "https", "rabbitmq"],
      "market_data_feed": ["https"],
      "risk_calculator": ["tomcat", "redis"],
      "mobile_api_gateway": ["https", "tomcat"],
      "atm_controller_01": ["tomcat"],
      "atm_controller_02": ["tomcat"],
      "swift_gateway": ["https"],
      "fraud_detection_01": ["tomcat", "elasticsearch", "redis"],
      "fraud_detection_02": ["tomcat", "elasticsearch", "redis"],
      "db_oracle_primary": ["ssh"],
      "db_oracle_standby": ["ssh"],
      "db_postgres_audit": ["postgresql"],
      "mq_primary": ["rabbitmq"],
      "redis_session_01": ["redis"],
      "hsm_connector": ["https"],
      "ldap_directory": ["ldap"]
    }
  },
  "service_port_mapping": {
    "http": [80],
    "https": [443],
    "ssh": [22],
    "mysql": [3306],
    "postgresql": [5432],
    "redis": [6379],
    "mongodb": [27017],
    "ftp": [21],
    "telnet": [23],
    "smtp": [25],
    "pop3": [110],
    "imap": [143],
    "tomcat": [8080],
    "nodejs": [3000],
    "rabbitmq": [5672],
    "prometheus": [9090],
    "grafana": [3000],
    "elasticsearch": [9200],
    "kibana": [5601],
    "smb": [445],
    "netbios": [139],
    "rdp": [3389],
    "vnc": [5900],
    "nfs": [2049],
    "ldap": [389],
    "rsync": [873],
    "snmp": [161],
    "tftp": [69]
  },
  "service_dependencies": {
    "core_banking_primary": {
      "tomcat": ["ssh"]
    },
    "core_banking_standby": {
      "tomcat": ["ssh"]
    },
    "trading_engine_01": {
      "tomcat": ["rabbitmq"]
    },
    "trading_engine_02": {
      "tomcat": ["rabbitmq"]
    },
    "risk_calculator": {
      "tomcat": ["redis"]
    },
    "web_banking_01": {
      "nodejs": ["tomcat"],
      "http": ["https"]
    },
    "web_banking_02": {
      "nodejs": ["tomcat"],
      "http": ["https"]
    },
    "pos_gateway": {
      "tomcat": ["https"]
    },
    "fraud_detection_01": {
      "tomcat": ["elasticsearch", "redis"]
    },
    "fraud_detection_02": {
      "tomcat": ["elasticsearch", "redis"]
    },
    "aml_scanner": {
      "tomcat": ["smtp"]
    },
    "report_generator": {
      "tomcat": ["smb"]
    },
    "siem_collector": {
      "kibana": ["elasticsearch"]
    },
    "dr_coordinator": {
      "tomcat": ["rsync"]
    }
  }
}
