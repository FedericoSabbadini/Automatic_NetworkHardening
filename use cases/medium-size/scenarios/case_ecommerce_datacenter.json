{
  "scenario_name": "ecommerce_datacenter",
  "description": "Data center e-commerce con 25 host: cluster web, microservizi, database replicati, cache distribuita, monitoring. Black Friday preparation.",
  "hosts": [
    {
      "id": "lb_primary",
      "open_ports": [80, 443, 22, 8080],
      "services": ["http", "https", "ssh", "tomcat"],
      "critical": false
    },
    {
      "id": "lb_secondary",
      "open_ports": [80, 443, 22, 8080],
      "services": ["http", "https", "ssh", "tomcat"],
      "critical": false
    },
    {
      "id": "web_node_01",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "web_node_02",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "web_node_03",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "web_node_04",
      "open_ports": [80, 443, 22, 3000],
      "services": ["http", "https", "ssh", "nodejs"],
      "critical": false
    },
    {
      "id": "api_gateway",
      "open_ports": [443, 8080, 22, 161],
      "services": ["https", "tomcat", "ssh", "snmp"],
      "critical": true
    },
    {
      "id": "cart_service",
      "open_ports": [8080, 22, 6379],
      "services": ["tomcat", "ssh", "redis"],
      "critical": true
    },
    {
      "id": "catalog_service",
      "open_ports": [8080, 22, 9200],
      "services": ["tomcat", "ssh", "elasticsearch"],
      "critical": true
    },
    {
      "id": "order_service",
      "open_ports": [8080, 22, 5672],
      "services": ["tomcat", "ssh", "rabbitmq"],
      "critical": true
    },
    {
      "id": "payment_service",
      "open_ports": [443, 8080, 22],
      "services": ["https", "tomcat", "ssh"],
      "critical": true
    },
    {
      "id": "notification_service",
      "open_ports": [8080, 25, 22],
      "services": ["tomcat", "smtp", "ssh"],
      "critical": false
    },
    {
      "id": "inventory_service",
      "open_ports": [8080, 22, 139],
      "services": ["tomcat", "ssh", "netbios"],
      "critical": false
    },
    {
      "id": "db_master",
      "open_ports": [3306, 22],
      "services": ["mysql", "ssh"],
      "critical": true
    },
    {
      "id": "db_replica_01",
      "open_ports": [3306, 22, 23],
      "services": ["mysql", "ssh"],
      "critical": true
    },
    {
      "id": "db_replica_02",
      "open_ports": [3306, 22, 23],
      "services": ["mysql", "ssh"],
      "critical": true
    },
    {
      "id": "redis_primary",
      "open_ports": [6379, 22],
      "services": ["redis", "ssh"],
      "critical": true
    },
    {
      "id": "redis_replica",
      "open_ports": [6379, 22, 161],
      "services": ["redis", "ssh", "snmp"],
      "critical": false
    },
    {
      "id": "elasticsearch_01",
      "open_ports": [9200, 9300, 22],
      "services": ["elasticsearch", "ssh"],
      "critical": true
    },
    {
      "id": "elasticsearch_02",
      "open_ports": [9200, 9300, 22, 139],
      "services": ["elasticsearch", "ssh"],
      "critical": false
    },
    {
      "id": "rabbitmq_cluster",
      "open_ports": [5672, 15672, 22, 161],
      "services": ["rabbitmq", "ssh", "snmp"],
      "critical": true
    },
    {
      "id": "monitoring_prometheus",
      "open_ports": [9090, 22, 23],
      "services": ["prometheus", "ssh"],
      "critical": false
    },
    {
      "id": "monitoring_grafana",
      "open_ports": [3000, 22, 80],
      "services": ["grafana", "ssh", "http"],
      "critical": false
    },
    {
      "id": "log_aggregator",
      "open_ports": [5601, 9200, 22, 514],
      "services": ["kibana", "elasticsearch", "ssh"],
      "critical": false
    },
    {
      "id": "admin_bastion",
      "open_ports": [22, 3389, 5900, 69],
      "services": ["ssh", "rdp", "vnc", "tftp"],
      "critical": false
    }
  ],
  "policy": {
    "forbidden_ports": [80, 23, 25, 139, 161, 69, 3389, 5900],
    "critical_services": {
      "api_gateway": ["https", "tomcat"],
      "cart_service": ["tomcat", "redis"],
      "catalog_service": ["tomcat", "elasticsearch"],
      "order_service": ["tomcat", "rabbitmq"],
      "payment_service": ["https", "tomcat"],
      "db_master": ["mysql"],
      "db_replica_01": ["mysql"],
      "db_replica_02": ["mysql"],
      "redis_primary": ["redis"],
      "elasticsearch_01": ["elasticsearch"],
      "rabbitmq_cluster": ["rabbitmq"]
    }
  },
  "service_port_mapping": {
    "http": [80],
    "https": [443],
    "ssh": [22],
    "mysql": [3306],
    "postgresql": [5432],
    "redis": [6379],
    "mongodb": [27017],
    "ftp": [21],
    "telnet": [23],
    "smtp": [25],
    "pop3": [110],
    "imap": [143],
    "tomcat": [8080],
    "nodejs": [3000],
    "rabbitmq": [5672],
    "prometheus": [9090],
    "grafana": [3000],
    "elasticsearch": [9200],
    "kibana": [5601],
    "smb": [445],
    "netbios": [139],
    "rdp": [3389],
    "vnc": [5900],
    "nfs": [2049],
    "ldap": [389],
    "rsync": [873],
    "snmp": [161],
    "tftp": [69]
  },
  "service_dependencies": {
    "lb_primary": {
      "http": ["nodejs"],
      "tomcat": ["nodejs"]
    },
    "lb_secondary": {
      "http": ["nodejs"],
      "tomcat": ["nodejs"]
    },
    "web_node_01": {
      "nodejs": ["tomcat"]
    },
    "web_node_02": {
      "nodejs": ["tomcat"]
    },
    "web_node_03": {
      "nodejs": ["tomcat"]
    },
    "web_node_04": {
      "nodejs": ["tomcat"]
    },
    "cart_service": {
      "tomcat": ["redis", "mysql"]
    },
    "catalog_service": {
      "tomcat": ["elasticsearch", "mysql"]
    },
    "order_service": {
      "tomcat": ["rabbitmq", "mysql"]
    },
    "payment_service": {
      "tomcat": ["mysql"]
    },
    "notification_service": {
      "tomcat": ["smtp", "rabbitmq"]
    },
    "inventory_service": {
      "tomcat": ["mysql"]
    },
    "monitoring_grafana": {
      "grafana": ["prometheus"]
    },
    "log_aggregator": {
      "kibana": ["elasticsearch"]
    }
  }
}
